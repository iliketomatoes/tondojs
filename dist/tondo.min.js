/*! tondo.js - v0.0.1 - 2016-03-13
* https://github.com/iliketomatoes/tondojs
* Copyright (c) 2016 ; Licensed  */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(b()):"object"==typeof module&&module.exports?module.exports=b():a.Tondo=b()}(window,function(){"use strict";function a(a,b,c,d){var e=["M",a-1,b,"a",c,c,0,1,d,1,0].join(" ");return e}function b(a,c){for(var d in c)c.hasOwnProperty(d)&&("object"==typeof c[d]&&null!==c[d]?a[d]=b(a[d],c[d]):a[d]=c[d]);return a}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}function d(a,d){var g={defaultClass:"tondo",customClass:"",tondoUp:{text:"",gap:0,side:"up"},tondoDown:{text:"",gap:0,side:"down"}},h=function(a,b,c){return Object.create(f,{target:{writable:!1,value:a},GUID:{writable:!1,value:b},settings:{writable:!0,value:c},proxy:{writable:!0,value:{}}})},i=b(g,d);this.instances=[];for(var j=document.querySelectorAll(a),k=0;j[k];){var l=c();e[l]=h(j[k],l,i),e[l].init(),this.instances.push(l),k++}}var e={},f={init:function(){this.proxy.targetWidth=this.getTargetWidth(),this.proxy.gap=this.getBiggestGap(),this.setLayout()},getTargetWidth:function(){var a=this.target.clientHeight,b=this.target.clientWidth;return b>=a?a:b},getRadius:function(a){return this.proxy.targetWidth/2+a},getBiggestGap:function(){var a=0,b=[this.settings.tondoUp,this.settings.tondoDown];for(var c in b)b[c].gap>a&&(a=b[c].gap);return a},setLayout:function(){var b,c,d,e,f,g,h,i,j,k,l;b=[this.settings.tondoUp,this.settings.tondoDown],console.log(b),c=this.proxy.targetWidth,d=c+2*this.proxy.gap,e=document.createDocumentFragment(),f="http://www.w3.org/2000/svg",g="http://www.w3.org/1999/xlink",i=this.settings.defaultClass+" "+this.settings.customClass,h=document.createElementNS(f,"svg"),h.setAttribute("class",i),h.setAttribute("width",d),h.setAttribute("height",d),h.setAttribute("data-tondo-id",this.GUID),j=this.target.offsetHeight-d,h.style.left=j/2+this.target.offsetLeft+"px",h.style.top=j/2+this.target.offsetTop+"px",k=[0,0,d,d].join(" "),h.setAttribute("viewBox",k),l=document.createElementNS(f,"defs");for(var m in b){var n,o,p,q,r,s,t,u;if(n=b[m].radius||this.getRadius(b[m].gap),o=this.GUID+"_"+m+"_"+b[m].side,p=document.createElementNS(f,"path"),p.setAttribute("id",o),"up"===b[m].side)p.setAttribute("d",a(d/2,d-(this.proxy.gap-b[m].gap),n,1));else{var v=d-2*n-this.proxy.gap+b[m].gap;p.setAttribute("d",a(d/2,v,n,0))}l.appendChild(p),q=document.createElementNS(f,"g"),r=document.createElementNS(f,"use"),r.setAttributeNS(g,"href","#"+o),q.appendChild(r),s=document.createElementNS(f,"textPath"),s.setAttributeNS(g,"href","#"+o),s.setAttribute("startOffset","50%"),s.setAttribute("text-anchor","middle"),t=b[m].text,s.textContent=t,u=document.createElementNS(f,"text"),u.appendChild(s),q.appendChild(u),h.appendChild(l),h.appendChild(q)}e.appendChild(h),this.target.parentNode.appendChild(e)}};return d});