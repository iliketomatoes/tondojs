/*! tondo.js - v0.0.1 - 2016-03-11
* https://github.com/iliketomatoes/tondojs
* Copyright (c) 2016 ; Licensed  */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(b()):"object"==typeof module&&module.exports?module.exports=b():a.Tondo=b()}(window,function(){"use strict";function a(a,b,c,d){var e=(d-90)*Math.PI/180;return{x:a+c*Math.cos(e),y:b+c*Math.sin(e)}}function b(b,c,d,e,f){var g=a(b,c,d,f),h=a(b,c,d,e),i=180>=f-e?"0":"1",j=["M",g.x,g.y,"A",d,d,0,i,0,h.x,h.y].join(" ");return j}function c(a,b,c){var d=c+","+c,e=2*c,f=["M",a,b,"m",-c,0,"a",d,"0 1,1",e.toString().concat(",0"),"a",d,"0 1,1",(-e).toString().concat(",0")].join(" ");return f}function d(a){return 2*Math.PI*a}function e(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function f(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}function g(a,b){var c={classes:"tondo"},d=function(a,b,c){return console.log(a),Object.create(k,{target:{writable:!1,value:a},GUID:{writable:!1,value:b},settings:{writable:!0,value:c},proxy:{writable:!0,value:{}}})},g=e(c,b);this.instances=[];for(var i=document.querySelectorAll(a),j=0;i[j];){var l=f();h[l]=d(i[j],l,g),h[l].init(),this.instances.push(l),j++}}var h={},i=.01,j=360,k={init:function(){this.proxy.targetWidth=this.getTargetWidth(),this.proxy.targetCoordinates=this.getTargetCoordinates(),this.setLayout(),this.setTextOffset()},getTargetWidth:function(){return this.target.clientWidth},getTargetCoordinates:function(){return this.target.getBoundingClientRect()},getRadius:function(a){return this.proxy.targetWidth/2+a},setLayout:function(){var a=this.settings.circles,d=this.proxy.targetWidth,e=0;for(var f in a)a[f].gap>e&&(e=a[f].gap);var g=d+2*e,h=document.createDocumentFragment(),k="http://www.w3.org/2000/svg",l="http://www.w3.org/1999/xlink",m=document.createElementNS(k,"svg");m.setAttribute("class",this.settings.classes),m.setAttribute("width",g),m.setAttribute("height",g),m.setAttribute("data-tondo-id",this.GUID);var n=this.target.parentNode.clientWidth-g;m.style.left=n/2+"px",m.style.top=n/2+"px";var o=[0,0,g,g].join(" ");m.setAttribute("viewBox",o);var p=document.createElementNS(k,"defs");for(var q in a){var r=a[q].radius||this.getRadius(a[q].gap),s=this.GUID+"_"+q+"_"+a[q].side,t=document.createElementNS(k,"path");t.setAttribute("id",s),"up"===a[q].side?t.setAttribute("d",c(g/2,g/2,r)):t.setAttribute("d",b(g/2,g/2,r,i,j)),p.appendChild(t);var u=document.createElementNS(k,"g"),v=document.createElementNS(k,"use");v.setAttributeNS(l,"href","#"+s),u.appendChild(v);var w=document.createElementNS(k,"textPath");w.setAttributeNS(l,"href","#"+s),"up"!==a[q].side&&(w.setAttribute("startOffset","50%"),w.setAttribute("text-anchor","middle"));var x=a[q].text;w.textContent=x;var y=document.createElementNS(k,"text");y.setAttribute("id",s+"_text"),y.appendChild(w),u.appendChild(y),m.appendChild(p),m.appendChild(u)}h.appendChild(m),this.target.parentNode.appendChild(h)},setTextOffset:function(){var a=this.settings.circles,b=this.target.parentNode.querySelector("svg[data-tondo-id]");for(var c in a)if("up"===a[c].side){var e=a[c].radius||this.getRadius(a[c].gap),f=this.GUID+"_"+c+"_"+a[c].side,g=b.getElementById(f+"_text"),h=g.querySelector("textPath"),i=g.getComputedTextLength(),j=d(e)/4,k=j-i/2;h.setAttribute("startOffset",k)}},setUpSidePath:function(a){var b=document.getElementById("circlePath");b.setAttribute("d",c(150,150,110));var e=(document.getElementsByTagName("text"),textEl.getComputedTextLength()),f=textEl.querySelector("textPath"),g=d(110)/4,h=g-e/2;console.log(textEl.getComputedTextLength()),console.log(h),f.setAttribute("startOffset",h)},setDownSidePath:function(a){var c=document.getElementById("test-path");c.setAttribute("d",b(150,150,100,i,j))}};return g});